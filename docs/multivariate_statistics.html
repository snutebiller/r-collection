<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Multivariate Statistics – r-collection</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-54ebed522ef0dc2f427e72bc89b6c217.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">r-collection</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">ggplot2</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./regression.html"> 
<span class="menu-text">regression</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./multivariate_statistics.html" aria-current="page"> 
<span class="menu-text">multivariate statistics</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#principal-component-analysis" id="toc-principal-component-analysis" class="nav-link active" data-scroll-target="#principal-component-analysis">Principal Component Analysis</a>
  <ul class="collapse">
  <li><a href="#model-definition" id="toc-model-definition" class="nav-link" data-scroll-target="#model-definition">Model Definition</a></li>
  <li><a href="#computation" id="toc-computation" class="nav-link" data-scroll-target="#computation">Computation</a></li>
  <li><a href="#properties" id="toc-properties" class="nav-link" data-scroll-target="#properties">Properties</a></li>
  <li><a href="#dimension-reduction" id="toc-dimension-reduction" class="nav-link" data-scroll-target="#dimension-reduction">Dimension Reduction</a></li>
  <li><a href="#practical-considerations" id="toc-practical-considerations" class="nav-link" data-scroll-target="#practical-considerations">Practical Considerations</a>
  <ul class="collapse">
  <li><a href="#interpretation-of-loadings" id="toc-interpretation-of-loadings" class="nav-link" data-scroll-target="#interpretation-of-loadings">Interpretation of Loadings</a></li>
  <li><a href="#scaling" id="toc-scaling" class="nav-link" data-scroll-target="#scaling">Scaling</a></li>
  <li><a href="#choosing-the-number-of-principle-components" id="toc-choosing-the-number-of-principle-components" class="nav-link" data-scroll-target="#choosing-the-number-of-principle-components">Choosing the Number of Principle Components</a></li>
  </ul></li>
  <li><a href="#predition-of-scores-for-new-observations" id="toc-predition-of-scores-for-new-observations" class="nav-link" data-scroll-target="#predition-of-scores-for-new-observations">Predition of Scores for New Observations</a></li>
  <li><a href="#case-study" id="toc-case-study" class="nav-link" data-scroll-target="#case-study">Case Study</a></li>
  <li><a href="#pca-by-hand" id="toc-pca-by-hand" class="nav-link" data-scroll-target="#pca-by-hand">PCA by Hand</a></li>
  </ul></li>
  <li><a href="#factor-analysis" id="toc-factor-analysis" class="nav-link" data-scroll-target="#factor-analysis">Factor Analysis</a>
  <ul class="collapse">
  <li><a href="#factor-model" id="toc-factor-model" class="nav-link" data-scroll-target="#factor-model">Factor Model</a></li>
  <li><a href="#estimation" id="toc-estimation" class="nav-link" data-scroll-target="#estimation">Estimation</a></li>
  <li><a href="#heywood-cases" id="toc-heywood-cases" class="nav-link" data-scroll-target="#heywood-cases">Heywood Cases</a></li>
  <li><a href="#number-of-factors" id="toc-number-of-factors" class="nav-link" data-scroll-target="#number-of-factors">Number of Factors</a></li>
  <li><a href="#interpretation-of-factor-loadings" id="toc-interpretation-of-factor-loadings" class="nav-link" data-scroll-target="#interpretation-of-factor-loadings">Interpretation of Factor Loadings</a></li>
  <li><a href="#estimation-of-factor-scores" id="toc-estimation-of-factor-scores" class="nav-link" data-scroll-target="#estimation-of-factor-scores">Estimation of Factor Scores</a></li>
  <li><a href="#comparison-between-fa-pca" id="toc-comparison-between-fa-pca" class="nav-link" data-scroll-target="#comparison-between-fa-pca">Comparison between FA &amp; PCA</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Multivariate Statistics</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>This page is based on the lecture Applied Multivariate Statistics <a href="https://www.vvz.ethz.ch/Vorlesungsverzeichnis/lerneinheit.view?semkez=2025S&amp;ansicht=KATALOGDATEN&amp;lerneinheitId=187848&amp;lang=en">401-0102-00L</a> held by Fabio Sigrist at ETH Zurich.</p>
<section id="principal-component-analysis" class="level1">
<h1>Principal Component Analysis</h1>
<p>Principal component analysis (PCA) aims at reducing a large number of variables to a smaller number while preserving as much variation as possible. This can be useful for visualizing data, but also to reduce the computational burden for other statistical techniques as well as simplifying regression problems by reducing collinearity.</p>
<section id="model-definition" class="level2">
<h2 class="anchored" data-anchor-id="model-definition">Model Definition</h2>
<p>The idea is to transform the data matrix <span class="math inline">\(\pmb{X} \in \mathbb{R}^{n\times q}\)</span> with the orthogonal loadings matrix <span class="math inline">\(\pmb{A} \in \mathbb{R}^{q\times q}\)</span> such that the transformed values <span class="math inline">\(\pmb{Y} \in \mathbb{R}^{n\times q}\)</span>, called scores, have maximal variance along the axes. <span class="math display">\[
\pmb{Y} = \pmb{X}\pmb{A}
\]</span> The k-th column in <span class="math inline">\(\pmb{Y}\)</span> and <span class="math inline">\(\pmb{A}\)</span> correspond to the <em>scores</em> and <em>loadings</em> of the k-th principle component, respectively. The loadings of each component <span class="math inline">\(k\)</span> are normalized <span class="math display">\[
\Sigma_{j=1}^q a_{jk}^2 = 1
\]</span> and the mean of each variable is zero. This can be achieved by subtracting the mean of the data. <span class="math display">\[
E(X_1) = \ldots = E(X_q) = 0
\]</span> Principle components are ordered according to their variances, with the first principle component having the largest. In addition, all subsequent principle components have to be <em>orthogonal</em> to the previous components.</p>
</section>
<section id="computation" class="level2">
<h2 class="anchored" data-anchor-id="computation">Computation</h2>
<p>There are multiple approaches to compute principle components, here, spectral decomposition of the covariance matrix <span class="math inline">\(\pmb{S} \in \mathbb{R}^{q\times q}\)</span> will be used. The spectral decomposition <span class="math display">\[
\pmb{S} = \pmb{A}\pmb{D}\pmb{A}^T
\]</span> yields the matrix <span class="math inline">\(\pmb{A} \in \mathbb{R}^{q\times q}\)</span>, in which the columns <span class="math inline">\(\pmb{a}_k\)</span> are the eigenvectors, and the matrix <span class="math inline">\(\pmb{D} \in \mathbb{R}^{q\times q}\)</span>. <span class="math inline">\(\pmb{D}\)</span> is a diagonal matrix whose elements <span class="math inline">\(\lambda_k\)</span> are the eigenvalues to <span class="math inline">\(\pmb{a}_k\)</span> and correspond to the variance of the associated eigenvector. Thus <span class="math display">\[
\pmb{S}\pmb{a}_k = \lambda_k\cdot\pmb{a}_k
\]</span> The algorithm to compute PCA with spectral decomposition is:</p>
<ol type="1">
<li>Calculate the eigenvalues <span class="math inline">\(\lambda_k\)</span> and eigenvectors <span class="math inline">\(\pmb{a}_k\)</span> from the sample covariance matrix <span class="math inline">\(\pmb{S}\)</span></li>
<li>Sort the eigenvalues in descending order and order the corresponding eigenvectors the same way</li>
<li>The k-th principle component is given by <span class="math display">\[
\pmb{y}_k = \pmb{X}\pmb{a}_k
\]</span></li>
</ol>
</section>
<section id="properties" class="level2">
<h2 class="anchored" data-anchor-id="properties">Properties</h2>
<p>The sample variance of principle component <span class="math inline">\(k\)</span> equals <span class="math inline">\(\lambda_k\)</span>, the k-th largest eigenvalue of <span class="math inline">\(\pmb{S}\)</span>. The total sample variance of all <span class="math inline">\(q\)</span> variables equals <span class="math display">\[
\mathrm{Tr}\left(\pmb{S}\right) = \mathrm{Tr}\left(\pmb{D}\right) = \Sigma_{j=1}^q \lambda_j
\]</span> and the first <span class="math inline">\(k\)</span> principle components explain a fraction of <span class="math display">\[
\frac{\Sigma_{j=1}^k\lambda_j}{\Sigma_{j=1}^q\lambda_j}
\]</span> of the total variance. The sample correlations between different <span class="math inline">\(\pmb{y}_k\)</span> are zero, since the eigenvectors, by definition, are orthogonal. <span class="math display">\[
\mathrm{Cor}(\pmb{y}_i, \pmb{y}_j) = 0, i \neq j
\]</span> The signs of the loadings are arbitrary, since <span class="math display">\[
\pmb{S} = \pmb{A}\pmb{D}\pmb{A}^T = (-\pmb{A})\pmb{D}(-\pmb{A})^T
\]</span></p>
</section>
<section id="dimension-reduction" class="level2">
<h2 class="anchored" data-anchor-id="dimension-reduction">Dimension Reduction</h2>
<p>Dimension reduction can be obtained by discarding principle components which account for a small fraction of the total variance. From <span class="math inline">\(\pmb{Y} = \pmb{X}\pmb{A}\)</span> it follows that <span class="math inline">\(\pmb{X} = \pmb{Y}\pmb{A}^T\)</span>. <span class="math inline">\(\pmb{A}\)</span> and <span class="math inline">\(\pmb{Y}\)</span> can then be split into sub-matrices such that <span class="math display">\[
\pmb{X} = \pmb{Y}\pmb{A}^T = \pmb{Y}^{(1)}\pmb{A}_1^T + \pmb{Y}^{(2)}\pmb{A}_2^T \approx \pmb{Y}^{(1)}\pmb{A}_1^T
\]</span> if <span class="math inline">\(\pmb{Y}^{(2)}\)</span> is small and its variance is close to zero. The dimensions of the loadings sub-matrices are <span class="math inline">\(\dim(\pmb{A_1}) = q \times k\)</span> and <span class="math inline">\(\dim(\pmb{A_2}) = q \times (q-k)\)</span>, with <span class="math inline">\(k\)</span> the number of principle components kept. The dimensions of the score matrices are <span class="math inline">\(\dim(\pmb{Y}^{(1)}) = n \times k\)</span> and <span class="math inline">\(\dim(\pmb{Y}^{(2)}) = n \times (q-k)\)</span></p>
</section>
<section id="practical-considerations" class="level2">
<h2 class="anchored" data-anchor-id="practical-considerations">Practical Considerations</h2>
<section id="interpretation-of-loadings" class="level3">
<h3 class="anchored" data-anchor-id="interpretation-of-loadings">Interpretation of Loadings</h3>
<p>When all variables are positively correlated, the first principle component is often a kind of average of the variables, while other principle components inform on the remaining patterns or shapes. Interpretation of principle components may be difficult, since all variables may have significant loadings within one principle component and can thus not be attributed to some particular set of variables.</p>
</section>
<section id="scaling" class="level3">
<h3 class="anchored" data-anchor-id="scaling">Scaling</h3>
<p>PCA is <em><strong>not</strong> scale-invariant</em>, as the scale (unit) in which the variable is measured changes the range of the values and with it its variance (e.g.&nbsp;centimeters vs.&nbsp;meters). If variables have large differences in their variances, the variable with the largest variances tends to dominate the first principle components. To overcome this issue, variables <span class="math inline">\(X_j\)</span> may be scaled by dividing by their standard deviation <span class="math inline">\(\sigma_j\)</span>, rendering the variances identical. <span class="math display">\[
X_j' = \frac{X_j}{\sigma_j}
\]</span> Scaling the data prior to PCA is often preferred, but involves the arbitrary choice to make variables equally important. Alternatively, PCA can be done using the correlation matrix <span class="math inline">\(\pmb{C}\)</span> instead of the covariance matrix, however, this is equal to scaling the data before calculating the covariance matrix.</p>
</section>
<section id="choosing-the-number-of-principle-components" class="level3">
<h3 class="anchored" data-anchor-id="choosing-the-number-of-principle-components">Choosing the Number of Principle Components</h3>
<p>There are no universal rules to choose the number of principle components for dimension reduction, however, a number rules of thumb exist.</p>
<ol type="1">
<li>The cumulative proportion of explained variance by <span class="math inline">\(k\)</span> principle components should be at least 0.8 <span class="math display">\[
\frac{\Sigma_{j=1}^k\lambda_j}{\Sigma_{j=1}^q\lambda_j} \geq 0.8
\]</span></li>
<li>Only those principle components with above-average variance are kept. If the correlation matrix or scaled data was used to perform PCA, this corresponds to all principle components whose eigenvalues are larger than 1. <span class="math display">\[
\lambda_k \geq \frac{1}{q}\Sigma_{j=1}^q\lambda_j
\]</span></li>
<li>Look at the scree plot of the variances <span class="math inline">\(\lambda_j\)</span> versus the component index <span class="math inline">\(j\)</span> and keep only those principle components that occur before the elbow.</li>
</ol>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="multivariate_statistics_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
<p>The effect of removing some principle components during dimension reduction may be different for different variables. To assess this effect, the squared correlations <span class="math inline">\(r_{ij}^2\)</span> between variable <span class="math inline">\(X_i\)</span> and principle component <span class="math inline">\(Y_j\)</span> may be consulted, as <span class="math inline">\(r_{ij}^2\)</span> corresponds to the proportion of variance of <span class="math inline">\(X_i\)</span> that is explained by <span class="math inline">\(Y_j\)</span>.</p>
</section>
</section>
<section id="predition-of-scores-for-new-observations" class="level2">
<h2 class="anchored" data-anchor-id="predition-of-scores-for-new-observations">Predition of Scores for New Observations</h2>
<p>The score of a new observation <span class="math inline">\(x = (x_1,\ldots,x_q)^t\)</span> can be calculated with the previously obtained loadings matrix <span class="math inline">\(\pmb{A}\)</span>. First, the new observation must be mean-subtracted with the sample-mean vector <span class="math inline">\(\hat{\mu}\)</span>. <span class="math display">\[
\tilde{x} = x-\hat{\mu} = (x_1 - \hat{\mu}_1, \ldots, x_q - \hat{\mu}_q)^T
\]</span> In case of scaling, the vector must be divided by the standard deviation vector <span class="math inline">\(\hat{\sigma}\)</span>. <span class="math display">\[
\tilde{x} = \frac{x-\hat{\mu}}{\hat{\sigma}}
\]</span> After pre-processing of the data, the scores of the new observation can be calculated by <span class="math display">\[
y = \pmb{A}^T\tilde{x}
\]</span></p>
</section>
<section id="case-study" class="level2">
<h2 class="anchored" data-anchor-id="case-study">Case Study</h2>
<p>The <code>heptathlon</code> dataset contains results from the olympic heptathlon competition in Seoul, 1988. It is a data frame with 25 observations on 8 variables: hurdles, highjump, shot, run200m, longjump, javelin, run800m, score. The variables hurdles, run200m, and run800m need to be transformed, such that a high value equals a good performance. This is done with the transformation <code>max(variable)-variable</code>.</p>
<div class="cell">
<div class="cell-output-display">
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:200px; ">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;"></th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">hurdles</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">highjump</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">shot</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">run200m</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">longjump</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">javelin</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">run800m</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">score</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Joyner-Kersee (USA)</td>
<td style="text-align: right;">2.16</td>
<td style="text-align: right;">1.86</td>
<td style="text-align: right;">15.80</td>
<td style="text-align: right;">4.05</td>
<td style="text-align: right;">7.27</td>
<td style="text-align: right;">45.66</td>
<td style="text-align: right;">18.16</td>
<td style="text-align: right;">7291</td>
</tr>
<tr class="even">
<td style="text-align: left;">John (GDR)</td>
<td style="text-align: right;">2.00</td>
<td style="text-align: right;">1.80</td>
<td style="text-align: right;">16.23</td>
<td style="text-align: right;">2.96</td>
<td style="text-align: right;">6.71</td>
<td style="text-align: right;">42.56</td>
<td style="text-align: right;">20.55</td>
<td style="text-align: right;">6897</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Behmer (GDR)</td>
<td style="text-align: right;">1.65</td>
<td style="text-align: right;">1.83</td>
<td style="text-align: right;">14.20</td>
<td style="text-align: right;">3.51</td>
<td style="text-align: right;">6.68</td>
<td style="text-align: right;">44.54</td>
<td style="text-align: right;">22.47</td>
<td style="text-align: right;">6858</td>
</tr>
<tr class="even">
<td style="text-align: left;">Sablovskaite (URS)</td>
<td style="text-align: right;">1.24</td>
<td style="text-align: right;">1.80</td>
<td style="text-align: right;">15.23</td>
<td style="text-align: right;">2.69</td>
<td style="text-align: right;">6.25</td>
<td style="text-align: right;">42.78</td>
<td style="text-align: right;">14.43</td>
<td style="text-align: right;">6540</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Choubenkova (URS)</td>
<td style="text-align: right;">1.34</td>
<td style="text-align: right;">1.74</td>
<td style="text-align: right;">14.76</td>
<td style="text-align: right;">2.68</td>
<td style="text-align: right;">6.32</td>
<td style="text-align: right;">47.46</td>
<td style="text-align: right;">18.77</td>
<td style="text-align: right;">6540</td>
</tr>
<tr class="even">
<td style="text-align: left;">Schulz (GDR)</td>
<td style="text-align: right;">1.10</td>
<td style="text-align: right;">1.83</td>
<td style="text-align: right;">13.50</td>
<td style="text-align: right;">1.96</td>
<td style="text-align: right;">6.33</td>
<td style="text-align: right;">42.82</td>
<td style="text-align: right;">20.88</td>
<td style="text-align: right;">6411</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Fleming (AUS)</td>
<td style="text-align: right;">1.47</td>
<td style="text-align: right;">1.80</td>
<td style="text-align: right;">12.88</td>
<td style="text-align: right;">3.02</td>
<td style="text-align: right;">6.37</td>
<td style="text-align: right;">40.28</td>
<td style="text-align: right;">14.13</td>
<td style="text-align: right;">6351</td>
</tr>
<tr class="even">
<td style="text-align: left;">Greiner (USA)</td>
<td style="text-align: right;">1.30</td>
<td style="text-align: right;">1.80</td>
<td style="text-align: right;">14.13</td>
<td style="text-align: right;">2.13</td>
<td style="text-align: right;">6.47</td>
<td style="text-align: right;">38.00</td>
<td style="text-align: right;">13.02</td>
<td style="text-align: right;">6297</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Lajbnerova (CZE)</td>
<td style="text-align: right;">1.22</td>
<td style="text-align: right;">1.83</td>
<td style="text-align: right;">14.28</td>
<td style="text-align: right;">1.75</td>
<td style="text-align: right;">6.11</td>
<td style="text-align: right;">42.20</td>
<td style="text-align: right;">10.62</td>
<td style="text-align: right;">6252</td>
</tr>
<tr class="even">
<td style="text-align: left;">Bouraga (URS)</td>
<td style="text-align: right;">1.60</td>
<td style="text-align: right;">1.77</td>
<td style="text-align: right;">12.62</td>
<td style="text-align: right;">3.02</td>
<td style="text-align: right;">6.28</td>
<td style="text-align: right;">39.06</td>
<td style="text-align: right;">11.93</td>
<td style="text-align: right;">6252</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Wijnsma (HOL)</td>
<td style="text-align: right;">1.10</td>
<td style="text-align: right;">1.86</td>
<td style="text-align: right;">13.01</td>
<td style="text-align: right;">1.58</td>
<td style="text-align: right;">6.34</td>
<td style="text-align: right;">37.86</td>
<td style="text-align: right;">15.18</td>
<td style="text-align: right;">6205</td>
</tr>
<tr class="even">
<td style="text-align: left;">Dimitrova (BUL)</td>
<td style="text-align: right;">1.61</td>
<td style="text-align: right;">1.80</td>
<td style="text-align: right;">12.88</td>
<td style="text-align: right;">3.02</td>
<td style="text-align: right;">6.37</td>
<td style="text-align: right;">40.28</td>
<td style="text-align: right;">14.13</td>
<td style="text-align: right;">6171</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Scheider (SWI)</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">1.86</td>
<td style="text-align: right;">11.58</td>
<td style="text-align: right;">1.74</td>
<td style="text-align: right;">6.05</td>
<td style="text-align: right;">47.50</td>
<td style="text-align: right;">11.74</td>
<td style="text-align: right;">6137</td>
</tr>
<tr class="even">
<td style="text-align: left;">Braun (FRG)</td>
<td style="text-align: right;">1.14</td>
<td style="text-align: right;">1.83</td>
<td style="text-align: right;">13.16</td>
<td style="text-align: right;">1.83</td>
<td style="text-align: right;">6.12</td>
<td style="text-align: right;">44.58</td>
<td style="text-align: right;">3.85</td>
<td style="text-align: right;">6109</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Ruotsalainen (FIN)</td>
<td style="text-align: right;">1.06</td>
<td style="text-align: right;">1.80</td>
<td style="text-align: right;">12.32</td>
<td style="text-align: right;">2.00</td>
<td style="text-align: right;">6.08</td>
<td style="text-align: right;">45.44</td>
<td style="text-align: right;">9.61</td>
<td style="text-align: right;">6101</td>
</tr>
<tr class="even">
<td style="text-align: left;">Yuping (CHN)</td>
<td style="text-align: right;">0.92</td>
<td style="text-align: right;">1.86</td>
<td style="text-align: right;">14.21</td>
<td style="text-align: right;">1.61</td>
<td style="text-align: right;">6.40</td>
<td style="text-align: right;">38.60</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">6087</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Hagger (GB)</td>
<td style="text-align: right;">1.38</td>
<td style="text-align: right;">1.80</td>
<td style="text-align: right;">12.75</td>
<td style="text-align: right;">1.14</td>
<td style="text-align: right;">6.34</td>
<td style="text-align: right;">35.76</td>
<td style="text-align: right;">8.19</td>
<td style="text-align: right;">5975</td>
</tr>
<tr class="even">
<td style="text-align: left;">Brown (USA)</td>
<td style="text-align: right;">0.78</td>
<td style="text-align: right;">1.83</td>
<td style="text-align: right;">12.69</td>
<td style="text-align: right;">1.78</td>
<td style="text-align: right;">6.13</td>
<td style="text-align: right;">44.34</td>
<td style="text-align: right;">0.24</td>
<td style="text-align: right;">5972</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Mulliner (GB)</td>
<td style="text-align: right;">0.46</td>
<td style="text-align: right;">1.71</td>
<td style="text-align: right;">12.68</td>
<td style="text-align: right;">1.69</td>
<td style="text-align: right;">6.10</td>
<td style="text-align: right;">37.76</td>
<td style="text-align: right;">8.65</td>
<td style="text-align: right;">5746</td>
</tr>
<tr class="even">
<td style="text-align: left;">Hautenauve (BEL)</td>
<td style="text-align: right;">0.81</td>
<td style="text-align: right;">1.77</td>
<td style="text-align: right;">11.81</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">5.99</td>
<td style="text-align: right;">35.68</td>
<td style="text-align: right;">12.77</td>
<td style="text-align: right;">5734</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Kytola (FIN)</td>
<td style="text-align: right;">0.54</td>
<td style="text-align: right;">1.77</td>
<td style="text-align: right;">11.66</td>
<td style="text-align: right;">0.92</td>
<td style="text-align: right;">5.75</td>
<td style="text-align: right;">39.48</td>
<td style="text-align: right;">13.32</td>
<td style="text-align: right;">5686</td>
</tr>
<tr class="even">
<td style="text-align: left;">Geremias (BRA)</td>
<td style="text-align: right;">0.62</td>
<td style="text-align: right;">1.71</td>
<td style="text-align: right;">12.95</td>
<td style="text-align: right;">1.11</td>
<td style="text-align: right;">5.50</td>
<td style="text-align: right;">39.64</td>
<td style="text-align: right;">2.65</td>
<td style="text-align: right;">5508</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Hui-Ing (TAI)</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">1.68</td>
<td style="text-align: right;">10.00</td>
<td style="text-align: right;">1.38</td>
<td style="text-align: right;">5.47</td>
<td style="text-align: right;">39.14</td>
<td style="text-align: right;">9.37</td>
<td style="text-align: right;">5290</td>
</tr>
<tr class="even">
<td style="text-align: left;">Jeong-Mi (KOR)</td>
<td style="text-align: right;">0.32</td>
<td style="text-align: right;">1.71</td>
<td style="text-align: right;">10.83</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">5.50</td>
<td style="text-align: right;">39.26</td>
<td style="text-align: right;">7.50</td>
<td style="text-align: right;">5289</td>
</tr>
</tbody>
</table>
</div>

</div>
</div>
<p>The correlation matrix indicates that some of the disciplines are well positively correlated, while others show very little correlation.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="multivariate_statistics_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
<p>The variances of the variables</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code> hurdles highjump     shot  run200m longjump  javelin  run800m 
    0.26     0.00     2.24     0.88     0.16    12.03    37.79 </code></pre>
</div>
</div>
<p>are on very different scales, such that it is preferable to perform the analysis on the correlation matrix instead.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(heptathlon_pca <span class="ot">&lt;-</span> <span class="fu">princomp</span>(c_heptathlon[,<span class="sc">-</span><span class="dv">8</span>], <span class="at">cor =</span> <span class="cn">TRUE</span>), <span class="at">loadings =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Importance of components:
                          Comp.1    Comp.2    Comp.3     Comp.4     Comp.5
Standard deviation     2.0793370 0.9481532 0.9109016 0.68319667 0.54618878
Proportion of Variance 0.6176632 0.1284278 0.1185345 0.06667967 0.04261745
Cumulative Proportion  0.6176632 0.7460909 0.8646255 0.93130515 0.97392260
                           Comp.6      Comp.7
Standard deviation     0.33745486 0.262042024
Proportion of Variance 0.01626797 0.009809432
Cumulative Proportion  0.99019057 1.000000000

Loadings:
         Comp.1 Comp.2 Comp.3 Comp.4 Comp.5 Comp.6 Comp.7
hurdles   0.450         0.174         0.199  0.847       
highjump  0.315 -0.651  0.209 -0.557               -0.332
shot      0.402         0.153  0.548 -0.672        -0.229
run200m   0.427  0.185 -0.130  0.231  0.618 -0.333 -0.470
longjump  0.451         0.270         0.122 -0.383  0.749
javelin   0.242 -0.326 -0.881                       0.211
run800m   0.303  0.657 -0.193 -0.574 -0.319              </code></pre>
</div>
</div>
<p>The “importance of the components” section informs on the standard deviation, the proportion of variance, and the cumulative proportion of the variance of each principle component. The <em>cumulative proportion of the variance</em> can be used to choose the number of dimensions for dimension reduction by choosing the first component <span class="math inline">\(k\)</span> as cutoff for which this value is larger than 0.8.</p>
<p>The loadings indiciate the weight that is given to each variable for a given principle component. Principle component 1 has exclusively positive loadings and can be taken as an average of all values, while the remaining components indicate differences to that average. Thus, an athlete with a high score in principle component 2 does better than the average in run200m and run800m, but worse in highjump and javelin.</p>
<p>This is exemplified by the case of athlete Scheider (SWI), who has a score of principle component 1 close to zero and is therefore close to the average, but has a low score for principle component 2. Due to the double-negative of negative score and negative loadings, she does very well in highjump and javelin.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="multivariate_statistics_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">hurdles</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">highjump</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">shot</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">run200m</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">longjump</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">javelin</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">run800m</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">score</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">average</td>
<td style="text-align: right;">1.12</td>
<td style="text-align: right;">1.79</td>
<td style="text-align: right;">13.17</td>
<td style="text-align: right;">2.02</td>
<td style="text-align: right;">6.21</td>
<td style="text-align: right;">41.28</td>
<td style="text-align: right;">11.76</td>
<td style="text-align: right;">6154.12</td>
</tr>
<tr class="even">
<td style="text-align: left;">Scheider (SWI)</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">1.86</td>
<td style="text-align: right;">11.58</td>
<td style="text-align: right;">1.74</td>
<td style="text-align: right;">6.05</td>
<td style="text-align: right;">47.50</td>
<td style="text-align: right;">11.74</td>
<td style="text-align: right;">6137.00</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>The scores for an additional athlete can be predicted using the <code>predict()</code> function as follows</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>athlete_new_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">hurdles =</span> <span class="dv">3</span>,</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">highjump =</span> <span class="fl">1.5</span>,</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">shot =</span> <span class="fl">9.5</span>,</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">run200m =</span> <span class="fl">1.8</span>,</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">longjump =</span> <span class="fl">6.8</span>,</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">javelin =</span> <span class="dv">37</span>,</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">run800m =</span> <span class="dv">25</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(heptathlon_pca, athlete_new_data)[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Comp.1     Comp.2 
-0.1903395  5.7786855 </code></pre>
</div>
</div>
</section>
<section id="pca-by-hand" class="level2">
<h2 class="anchored" data-anchor-id="pca-by-hand">PCA by Hand</h2>
<p>To illustrate how PCA works, PCA is done on the <code>iris</code> data set without using dedicated PCA functions. The <code>iris</code> data set contains four continuous and one categorical variable, only the continuous variables are considered. First, the variables need to be mean-subtracted</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>iris_centered <span class="ot">&lt;-</span> <span class="fu">apply</span>(iris[,<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>], <span class="dv">2</span>, <span class="cf">function</span>(x) x<span class="sc">-</span><span class="fu">mean</span>(x))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Afterwards, the spectral decomposition of the covariance matrix is calculated using the <code>eigen()</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>iris_eigen <span class="ot">&lt;-</span> iris_centered <span class="sc">|&gt;</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cov</span>() <span class="sc">|&gt;</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">eigen</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The eigenvalues correspond to the variance of the corresponding eigenvector. The eigenvector matrix is identical to the loadings calculated by <code>printcomp()</code>, except for the signs.</p>
<div class="cell">
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">PC1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">PC2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">PC3</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">PC4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">eigenvalues</td>
<td style="text-align: right;">4.23</td>
<td style="text-align: right;">0.24</td>
<td style="text-align: right;">0.08</td>
<td style="text-align: right;">0.02</td>
</tr>
</tbody>
</table>


</div>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<caption>The eigenvectors correspond to the loadings of the principal components</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">PC1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">PC2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">PC3</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">PC4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Sepal.Length</td>
<td style="text-align: right;">0.361</td>
<td style="text-align: right;">-0.657</td>
<td style="text-align: right;">0.582</td>
<td style="text-align: right;">0.315</td>
</tr>
<tr class="even">
<td style="text-align: left;">Sepal.Width</td>
<td style="text-align: right;">-0.085</td>
<td style="text-align: right;">-0.730</td>
<td style="text-align: right;">-0.598</td>
<td style="text-align: right;">-0.320</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Petal.Length</td>
<td style="text-align: right;">0.857</td>
<td style="text-align: right;">0.173</td>
<td style="text-align: right;">-0.076</td>
<td style="text-align: right;">-0.480</td>
</tr>
<tr class="even">
<td style="text-align: left;">Petal.Width</td>
<td style="text-align: right;">0.358</td>
<td style="text-align: right;">0.075</td>
<td style="text-align: right;">-0.546</td>
<td style="text-align: right;">0.754</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>The scores are calculated from the data matrix and the eigenvector matrix</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>iris_centered<span class="sc">%*%</span>iris_eigen<span class="sc">$</span>vectors</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:200px; ">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">PC1</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">PC2</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">PC3</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">PC4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">-2.68</td>
<td style="text-align: right;">-0.32</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">0.00</td>
</tr>
<tr class="even">
<td style="text-align: right;">-2.71</td>
<td style="text-align: right;">0.18</td>
<td style="text-align: right;">0.21</td>
<td style="text-align: right;">0.10</td>
</tr>
<tr class="odd">
<td style="text-align: right;">-2.89</td>
<td style="text-align: right;">0.14</td>
<td style="text-align: right;">-0.02</td>
<td style="text-align: right;">0.02</td>
</tr>
<tr class="even">
<td style="text-align: right;">-2.75</td>
<td style="text-align: right;">0.32</td>
<td style="text-align: right;">-0.03</td>
<td style="text-align: right;">-0.08</td>
</tr>
<tr class="odd">
<td style="text-align: right;">-2.73</td>
<td style="text-align: right;">-0.33</td>
<td style="text-align: right;">-0.09</td>
<td style="text-align: right;">-0.06</td>
</tr>
<tr class="even">
<td style="text-align: right;">-2.28</td>
<td style="text-align: right;">-0.74</td>
<td style="text-align: right;">-0.17</td>
<td style="text-align: right;">-0.02</td>
</tr>
<tr class="odd">
<td style="text-align: right;">-2.82</td>
<td style="text-align: right;">0.09</td>
<td style="text-align: right;">-0.26</td>
<td style="text-align: right;">-0.05</td>
</tr>
<tr class="even">
<td style="text-align: right;">-2.63</td>
<td style="text-align: right;">-0.16</td>
<td style="text-align: right;">0.02</td>
<td style="text-align: right;">-0.05</td>
</tr>
<tr class="odd">
<td style="text-align: right;">-2.89</td>
<td style="text-align: right;">0.58</td>
<td style="text-align: right;">-0.02</td>
<td style="text-align: right;">-0.03</td>
</tr>
<tr class="even">
<td style="text-align: right;">-2.67</td>
<td style="text-align: right;">0.11</td>
<td style="text-align: right;">0.20</td>
<td style="text-align: right;">-0.06</td>
</tr>
<tr class="odd">
<td style="text-align: right;">-2.51</td>
<td style="text-align: right;">-0.65</td>
<td style="text-align: right;">0.08</td>
<td style="text-align: right;">-0.02</td>
</tr>
<tr class="even">
<td style="text-align: right;">-2.61</td>
<td style="text-align: right;">-0.01</td>
<td style="text-align: right;">-0.10</td>
<td style="text-align: right;">-0.16</td>
</tr>
<tr class="odd">
<td style="text-align: right;">-2.79</td>
<td style="text-align: right;">0.24</td>
<td style="text-align: right;">0.21</td>
<td style="text-align: right;">-0.01</td>
</tr>
<tr class="even">
<td style="text-align: right;">-3.22</td>
<td style="text-align: right;">0.51</td>
<td style="text-align: right;">-0.06</td>
<td style="text-align: right;">-0.02</td>
</tr>
<tr class="odd">
<td style="text-align: right;">-2.64</td>
<td style="text-align: right;">-1.18</td>
<td style="text-align: right;">0.15</td>
<td style="text-align: right;">0.16</td>
</tr>
<tr class="even">
<td style="text-align: right;">-2.39</td>
<td style="text-align: right;">-1.34</td>
<td style="text-align: right;">-0.28</td>
<td style="text-align: right;">0.01</td>
</tr>
<tr class="odd">
<td style="text-align: right;">-2.62</td>
<td style="text-align: right;">-0.81</td>
<td style="text-align: right;">-0.14</td>
<td style="text-align: right;">0.17</td>
</tr>
<tr class="even">
<td style="text-align: right;">-2.65</td>
<td style="text-align: right;">-0.31</td>
<td style="text-align: right;">-0.03</td>
<td style="text-align: right;">0.08</td>
</tr>
<tr class="odd">
<td style="text-align: right;">-2.20</td>
<td style="text-align: right;">-0.87</td>
<td style="text-align: right;">0.12</td>
<td style="text-align: right;">0.03</td>
</tr>
<tr class="even">
<td style="text-align: right;">-2.59</td>
<td style="text-align: right;">-0.51</td>
<td style="text-align: right;">-0.21</td>
<td style="text-align: right;">-0.07</td>
</tr>
<tr class="odd">
<td style="text-align: right;">-2.31</td>
<td style="text-align: right;">-0.39</td>
<td style="text-align: right;">0.24</td>
<td style="text-align: right;">-0.02</td>
</tr>
<tr class="even">
<td style="text-align: right;">-2.54</td>
<td style="text-align: right;">-0.43</td>
<td style="text-align: right;">-0.21</td>
<td style="text-align: right;">0.04</td>
</tr>
<tr class="odd">
<td style="text-align: right;">-3.22</td>
<td style="text-align: right;">-0.13</td>
<td style="text-align: right;">-0.29</td>
<td style="text-align: right;">0.00</td>
</tr>
<tr class="even">
<td style="text-align: right;">-2.30</td>
<td style="text-align: right;">-0.10</td>
<td style="text-align: right;">-0.04</td>
<td style="text-align: right;">0.15</td>
</tr>
<tr class="odd">
<td style="text-align: right;">-2.36</td>
<td style="text-align: right;">0.04</td>
<td style="text-align: right;">-0.13</td>
<td style="text-align: right;">-0.30</td>
</tr>
<tr class="even">
<td style="text-align: right;">-2.51</td>
<td style="text-align: right;">0.15</td>
<td style="text-align: right;">0.25</td>
<td style="text-align: right;">0.03</td>
</tr>
<tr class="odd">
<td style="text-align: right;">-2.47</td>
<td style="text-align: right;">-0.13</td>
<td style="text-align: right;">-0.09</td>
<td style="text-align: right;">0.06</td>
</tr>
<tr class="even">
<td style="text-align: right;">-2.56</td>
<td style="text-align: right;">-0.37</td>
<td style="text-align: right;">0.08</td>
<td style="text-align: right;">-0.01</td>
</tr>
<tr class="odd">
<td style="text-align: right;">-2.64</td>
<td style="text-align: right;">-0.31</td>
<td style="text-align: right;">0.15</td>
<td style="text-align: right;">0.07</td>
</tr>
<tr class="even">
<td style="text-align: right;">-2.63</td>
<td style="text-align: right;">0.20</td>
<td style="text-align: right;">-0.04</td>
<td style="text-align: right;">-0.12</td>
</tr>
<tr class="odd">
<td style="text-align: right;">-2.59</td>
<td style="text-align: right;">0.20</td>
<td style="text-align: right;">0.08</td>
<td style="text-align: right;">-0.06</td>
</tr>
<tr class="even">
<td style="text-align: right;">-2.41</td>
<td style="text-align: right;">-0.41</td>
<td style="text-align: right;">0.15</td>
<td style="text-align: right;">0.23</td>
</tr>
<tr class="odd">
<td style="text-align: right;">-2.65</td>
<td style="text-align: right;">-0.81</td>
<td style="text-align: right;">-0.23</td>
<td style="text-align: right;">-0.28</td>
</tr>
<tr class="even">
<td style="text-align: right;">-2.60</td>
<td style="text-align: right;">-1.09</td>
<td style="text-align: right;">-0.16</td>
<td style="text-align: right;">-0.10</td>
</tr>
<tr class="odd">
<td style="text-align: right;">-2.64</td>
<td style="text-align: right;">0.12</td>
<td style="text-align: right;">0.14</td>
<td style="text-align: right;">0.02</td>
</tr>
<tr class="even">
<td style="text-align: right;">-2.87</td>
<td style="text-align: right;">-0.07</td>
<td style="text-align: right;">0.16</td>
<td style="text-align: right;">0.16</td>
</tr>
<tr class="odd">
<td style="text-align: right;">-2.63</td>
<td style="text-align: right;">-0.60</td>
<td style="text-align: right;">0.27</td>
<td style="text-align: right;">0.18</td>
</tr>
<tr class="even">
<td style="text-align: right;">-2.80</td>
<td style="text-align: right;">-0.27</td>
<td style="text-align: right;">-0.09</td>
<td style="text-align: right;">-0.17</td>
</tr>
<tr class="odd">
<td style="text-align: right;">-2.98</td>
<td style="text-align: right;">0.49</td>
<td style="text-align: right;">-0.07</td>
<td style="text-align: right;">-0.01</td>
</tr>
<tr class="even">
<td style="text-align: right;">-2.59</td>
<td style="text-align: right;">-0.23</td>
<td style="text-align: right;">0.08</td>
<td style="text-align: right;">-0.01</td>
</tr>
<tr class="odd">
<td style="text-align: right;">-2.77</td>
<td style="text-align: right;">-0.26</td>
<td style="text-align: right;">-0.08</td>
<td style="text-align: right;">0.09</td>
</tr>
<tr class="even">
<td style="text-align: right;">-2.85</td>
<td style="text-align: right;">0.94</td>
<td style="text-align: right;">0.35</td>
<td style="text-align: right;">0.32</td>
</tr>
<tr class="odd">
<td style="text-align: right;">-3.00</td>
<td style="text-align: right;">0.34</td>
<td style="text-align: right;">-0.19</td>
<td style="text-align: right;">-0.07</td>
</tr>
<tr class="even">
<td style="text-align: right;">-2.41</td>
<td style="text-align: right;">-0.19</td>
<td style="text-align: right;">-0.26</td>
<td style="text-align: right;">0.18</td>
</tr>
<tr class="odd">
<td style="text-align: right;">-2.21</td>
<td style="text-align: right;">-0.44</td>
<td style="text-align: right;">-0.30</td>
<td style="text-align: right;">-0.18</td>
</tr>
<tr class="even">
<td style="text-align: right;">-2.71</td>
<td style="text-align: right;">0.25</td>
<td style="text-align: right;">0.10</td>
<td style="text-align: right;">0.14</td>
</tr>
<tr class="odd">
<td style="text-align: right;">-2.54</td>
<td style="text-align: right;">-0.50</td>
<td style="text-align: right;">-0.17</td>
<td style="text-align: right;">-0.19</td>
</tr>
<tr class="even">
<td style="text-align: right;">-2.84</td>
<td style="text-align: right;">0.23</td>
<td style="text-align: right;">-0.08</td>
<td style="text-align: right;">-0.06</td>
</tr>
<tr class="odd">
<td style="text-align: right;">-2.54</td>
<td style="text-align: right;">-0.58</td>
<td style="text-align: right;">0.02</td>
<td style="text-align: right;">-0.05</td>
</tr>
<tr class="even">
<td style="text-align: right;">-2.70</td>
<td style="text-align: right;">-0.11</td>
<td style="text-align: right;">0.09</td>
<td style="text-align: right;">0.03</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.28</td>
<td style="text-align: right;">-0.69</td>
<td style="text-align: right;">0.41</td>
<td style="text-align: right;">0.02</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.93</td>
<td style="text-align: right;">-0.32</td>
<td style="text-align: right;">0.02</td>
<td style="text-align: right;">0.00</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.46</td>
<td style="text-align: right;">-0.50</td>
<td style="text-align: right;">0.34</td>
<td style="text-align: right;">0.00</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.18</td>
<td style="text-align: right;">0.83</td>
<td style="text-align: right;">0.18</td>
<td style="text-align: right;">0.09</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.09</td>
<td style="text-align: right;">-0.07</td>
<td style="text-align: right;">0.31</td>
<td style="text-align: right;">0.11</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.64</td>
<td style="text-align: right;">0.42</td>
<td style="text-align: right;">-0.04</td>
<td style="text-align: right;">-0.24</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.10</td>
<td style="text-align: right;">-0.28</td>
<td style="text-align: right;">-0.17</td>
<td style="text-align: right;">-0.08</td>
</tr>
<tr class="even">
<td style="text-align: right;">-0.75</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">-0.01</td>
<td style="text-align: right;">-0.02</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.04</td>
<td style="text-align: right;">-0.23</td>
<td style="text-align: right;">0.42</td>
<td style="text-align: right;">-0.04</td>
</tr>
<tr class="even">
<td style="text-align: right;">-0.01</td>
<td style="text-align: right;">0.72</td>
<td style="text-align: right;">-0.28</td>
<td style="text-align: right;">-0.01</td>
</tr>
<tr class="odd">
<td style="text-align: right;">-0.51</td>
<td style="text-align: right;">1.27</td>
<td style="text-align: right;">0.27</td>
<td style="text-align: right;">0.05</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.51</td>
<td style="text-align: right;">0.10</td>
<td style="text-align: right;">-0.13</td>
<td style="text-align: right;">0.05</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.26</td>
<td style="text-align: right;">0.55</td>
<td style="text-align: right;">0.69</td>
<td style="text-align: right;">0.06</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.98</td>
<td style="text-align: right;">0.12</td>
<td style="text-align: right;">0.06</td>
<td style="text-align: right;">-0.17</td>
</tr>
<tr class="odd">
<td style="text-align: right;">-0.17</td>
<td style="text-align: right;">0.25</td>
<td style="text-align: right;">-0.09</td>
<td style="text-align: right;">0.13</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.93</td>
<td style="text-align: right;">-0.47</td>
<td style="text-align: right;">0.31</td>
<td style="text-align: right;">0.10</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.66</td>
<td style="text-align: right;">0.35</td>
<td style="text-align: right;">-0.33</td>
<td style="text-align: right;">-0.19</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.24</td>
<td style="text-align: right;">0.33</td>
<td style="text-align: right;">0.27</td>
<td style="text-align: right;">-0.21</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.94</td>
<td style="text-align: right;">0.54</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">0.26</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">0.58</td>
<td style="text-align: right;">0.24</td>
<td style="text-align: right;">-0.04</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.12</td>
<td style="text-align: right;">0.08</td>
<td style="text-align: right;">-0.46</td>
<td style="text-align: right;">-0.08</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.36</td>
<td style="text-align: right;">0.07</td>
<td style="text-align: right;">0.23</td>
<td style="text-align: right;">0.12</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.30</td>
<td style="text-align: right;">0.33</td>
<td style="text-align: right;">0.35</td>
<td style="text-align: right;">0.00</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.92</td>
<td style="text-align: right;">0.18</td>
<td style="text-align: right;">0.23</td>
<td style="text-align: right;">-0.29</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.71</td>
<td style="text-align: right;">-0.15</td>
<td style="text-align: right;">0.32</td>
<td style="text-align: right;">0.04</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.90</td>
<td style="text-align: right;">-0.33</td>
<td style="text-align: right;">0.32</td>
<td style="text-align: right;">0.10</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.33</td>
<td style="text-align: right;">-0.24</td>
<td style="text-align: right;">0.52</td>
<td style="text-align: right;">0.04</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.56</td>
<td style="text-align: right;">-0.27</td>
<td style="text-align: right;">0.16</td>
<td style="text-align: right;">0.07</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.81</td>
<td style="text-align: right;">0.16</td>
<td style="text-align: right;">-0.04</td>
<td style="text-align: right;">-0.03</td>
</tr>
<tr class="even">
<td style="text-align: right;">-0.31</td>
<td style="text-align: right;">0.37</td>
<td style="text-align: right;">0.32</td>
<td style="text-align: right;">0.07</td>
</tr>
<tr class="odd">
<td style="text-align: right;">-0.07</td>
<td style="text-align: right;">0.71</td>
<td style="text-align: right;">0.24</td>
<td style="text-align: right;">0.01</td>
</tr>
<tr class="even">
<td style="text-align: right;">-0.19</td>
<td style="text-align: right;">0.68</td>
<td style="text-align: right;">0.31</td>
<td style="text-align: right;">-0.02</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.14</td>
<td style="text-align: right;">0.31</td>
<td style="text-align: right;">0.18</td>
<td style="text-align: right;">0.03</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.38</td>
<td style="text-align: right;">0.42</td>
<td style="text-align: right;">-0.02</td>
<td style="text-align: right;">-0.18</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.59</td>
<td style="text-align: right;">0.48</td>
<td style="text-align: right;">-0.44</td>
<td style="text-align: right;">-0.25</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.81</td>
<td style="text-align: right;">-0.19</td>
<td style="text-align: right;">-0.39</td>
<td style="text-align: right;">-0.11</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.22</td>
<td style="text-align: right;">-0.41</td>
<td style="text-align: right;">0.24</td>
<td style="text-align: right;">0.03</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.82</td>
<td style="text-align: right;">0.37</td>
<td style="text-align: right;">0.61</td>
<td style="text-align: right;">0.15</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.25</td>
<td style="text-align: right;">0.27</td>
<td style="text-align: right;">-0.19</td>
<td style="text-align: right;">-0.15</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.17</td>
<td style="text-align: right;">0.68</td>
<td style="text-align: right;">0.06</td>
<td style="text-align: right;">0.03</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.46</td>
<td style="text-align: right;">0.67</td>
<td style="text-align: right;">0.02</td>
<td style="text-align: right;">-0.27</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.89</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">-0.15</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.23</td>
<td style="text-align: right;">0.40</td>
<td style="text-align: right;">0.23</td>
<td style="text-align: right;">0.02</td>
</tr>
<tr class="even">
<td style="text-align: right;">-0.70</td>
<td style="text-align: right;">1.01</td>
<td style="text-align: right;">0.11</td>
<td style="text-align: right;">0.05</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.36</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">-0.02</td>
<td style="text-align: right;">-0.10</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.33</td>
<td style="text-align: right;">0.21</td>
<td style="text-align: right;">-0.08</td>
<td style="text-align: right;">-0.24</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.38</td>
<td style="text-align: right;">0.29</td>
<td style="text-align: right;">-0.08</td>
<td style="text-align: right;">-0.13</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.64</td>
<td style="text-align: right;">-0.02</td>
<td style="text-align: right;">0.21</td>
<td style="text-align: right;">-0.02</td>
</tr>
<tr class="odd">
<td style="text-align: right;">-0.91</td>
<td style="text-align: right;">0.76</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">0.23</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.30</td>
<td style="text-align: right;">0.35</td>
<td style="text-align: right;">-0.01</td>
<td style="text-align: right;">-0.05</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2.53</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">-0.76</td>
<td style="text-align: right;">-0.03</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.42</td>
<td style="text-align: right;">0.57</td>
<td style="text-align: right;">-0.30</td>
<td style="text-align: right;">-0.02</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2.62</td>
<td style="text-align: right;">-0.34</td>
<td style="text-align: right;">0.11</td>
<td style="text-align: right;">0.07</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.97</td>
<td style="text-align: right;">0.18</td>
<td style="text-align: right;">-0.11</td>
<td style="text-align: right;">-0.24</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2.35</td>
<td style="text-align: right;">0.04</td>
<td style="text-align: right;">-0.29</td>
<td style="text-align: right;">0.00</td>
</tr>
<tr class="even">
<td style="text-align: right;">3.40</td>
<td style="text-align: right;">-0.55</td>
<td style="text-align: right;">0.35</td>
<td style="text-align: right;">-0.11</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.52</td>
<td style="text-align: right;">1.19</td>
<td style="text-align: right;">-0.55</td>
<td style="text-align: right;">-0.10</td>
</tr>
<tr class="even">
<td style="text-align: right;">2.93</td>
<td style="text-align: right;">-0.36</td>
<td style="text-align: right;">0.42</td>
<td style="text-align: right;">-0.26</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2.32</td>
<td style="text-align: right;">0.24</td>
<td style="text-align: right;">0.35</td>
<td style="text-align: right;">-0.08</td>
</tr>
<tr class="even">
<td style="text-align: right;">2.92</td>
<td style="text-align: right;">-0.78</td>
<td style="text-align: right;">-0.42</td>
<td style="text-align: right;">0.11</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.66</td>
<td style="text-align: right;">-0.24</td>
<td style="text-align: right;">-0.24</td>
<td style="text-align: right;">0.12</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.80</td>
<td style="text-align: right;">0.22</td>
<td style="text-align: right;">0.04</td>
<td style="text-align: right;">0.08</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2.17</td>
<td style="text-align: right;">-0.22</td>
<td style="text-align: right;">-0.03</td>
<td style="text-align: right;">0.16</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.35</td>
<td style="text-align: right;">0.78</td>
<td style="text-align: right;">-0.28</td>
<td style="text-align: right;">0.14</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.59</td>
<td style="text-align: right;">0.54</td>
<td style="text-align: right;">-0.63</td>
<td style="text-align: right;">0.33</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.90</td>
<td style="text-align: right;">-0.12</td>
<td style="text-align: right;">-0.48</td>
<td style="text-align: right;">0.22</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.95</td>
<td style="text-align: right;">-0.04</td>
<td style="text-align: right;">-0.04</td>
<td style="text-align: right;">-0.16</td>
</tr>
<tr class="even">
<td style="text-align: right;">3.49</td>
<td style="text-align: right;">-1.18</td>
<td style="text-align: right;">-0.13</td>
<td style="text-align: right;">-0.31</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3.80</td>
<td style="text-align: right;">-0.26</td>
<td style="text-align: right;">0.51</td>
<td style="text-align: right;">0.05</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.30</td>
<td style="text-align: right;">0.76</td>
<td style="text-align: right;">0.34</td>
<td style="text-align: right;">-0.05</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2.43</td>
<td style="text-align: right;">-0.38</td>
<td style="text-align: right;">-0.22</td>
<td style="text-align: right;">0.19</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.20</td>
<td style="text-align: right;">0.61</td>
<td style="text-align: right;">-0.51</td>
<td style="text-align: right;">0.06</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3.50</td>
<td style="text-align: right;">-0.46</td>
<td style="text-align: right;">0.57</td>
<td style="text-align: right;">-0.14</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.39</td>
<td style="text-align: right;">0.20</td>
<td style="text-align: right;">0.06</td>
<td style="text-align: right;">0.16</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2.28</td>
<td style="text-align: right;">-0.33</td>
<td style="text-align: right;">-0.29</td>
<td style="text-align: right;">-0.06</td>
</tr>
<tr class="even">
<td style="text-align: right;">2.61</td>
<td style="text-align: right;">-0.56</td>
<td style="text-align: right;">0.21</td>
<td style="text-align: right;">-0.24</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.26</td>
<td style="text-align: right;">0.18</td>
<td style="text-align: right;">-0.05</td>
<td style="text-align: right;">0.15</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.29</td>
<td style="text-align: right;">0.12</td>
<td style="text-align: right;">-0.23</td>
<td style="text-align: right;">0.00</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2.12</td>
<td style="text-align: right;">0.21</td>
<td style="text-align: right;">-0.15</td>
<td style="text-align: right;">0.05</td>
</tr>
<tr class="even">
<td style="text-align: right;">2.39</td>
<td style="text-align: right;">-0.46</td>
<td style="text-align: right;">0.45</td>
<td style="text-align: right;">-0.23</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2.84</td>
<td style="text-align: right;">-0.38</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">-0.02</td>
</tr>
<tr class="even">
<td style="text-align: right;">3.23</td>
<td style="text-align: right;">-1.37</td>
<td style="text-align: right;">0.11</td>
<td style="text-align: right;">-0.25</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2.16</td>
<td style="text-align: right;">0.22</td>
<td style="text-align: right;">-0.21</td>
<td style="text-align: right;">0.13</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.44</td>
<td style="text-align: right;">0.14</td>
<td style="text-align: right;">0.15</td>
<td style="text-align: right;">-0.19</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.78</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">0.17</td>
<td style="text-align: right;">-0.51</td>
</tr>
<tr class="even">
<td style="text-align: right;">3.08</td>
<td style="text-align: right;">-0.69</td>
<td style="text-align: right;">0.34</td>
<td style="text-align: right;">0.31</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2.14</td>
<td style="text-align: right;">-0.14</td>
<td style="text-align: right;">-0.73</td>
<td style="text-align: right;">0.06</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.91</td>
<td style="text-align: right;">-0.05</td>
<td style="text-align: right;">-0.16</td>
<td style="text-align: right;">-0.22</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.17</td>
<td style="text-align: right;">0.16</td>
<td style="text-align: right;">-0.28</td>
<td style="text-align: right;">0.02</td>
</tr>
<tr class="even">
<td style="text-align: right;">2.11</td>
<td style="text-align: right;">-0.37</td>
<td style="text-align: right;">-0.03</td>
<td style="text-align: right;">0.21</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2.31</td>
<td style="text-align: right;">-0.18</td>
<td style="text-align: right;">-0.32</td>
<td style="text-align: right;">0.28</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.92</td>
<td style="text-align: right;">-0.41</td>
<td style="text-align: right;">-0.11</td>
<td style="text-align: right;">0.51</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.42</td>
<td style="text-align: right;">0.57</td>
<td style="text-align: right;">-0.30</td>
<td style="text-align: right;">-0.02</td>
</tr>
<tr class="even">
<td style="text-align: right;">2.56</td>
<td style="text-align: right;">-0.28</td>
<td style="text-align: right;">-0.29</td>
<td style="text-align: right;">0.06</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2.42</td>
<td style="text-align: right;">-0.30</td>
<td style="text-align: right;">-0.50</td>
<td style="text-align: right;">0.24</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.94</td>
<td style="text-align: right;">-0.19</td>
<td style="text-align: right;">-0.18</td>
<td style="text-align: right;">0.43</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.53</td>
<td style="text-align: right;">0.38</td>
<td style="text-align: right;">0.12</td>
<td style="text-align: right;">0.25</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.76</td>
<td style="text-align: right;">-0.08</td>
<td style="text-align: right;">-0.13</td>
<td style="text-align: right;">0.14</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.90</td>
<td style="text-align: right;">-0.12</td>
<td style="text-align: right;">-0.72</td>
<td style="text-align: right;">0.04</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.39</td>
<td style="text-align: right;">0.28</td>
<td style="text-align: right;">-0.36</td>
<td style="text-align: right;">-0.16</td>
</tr>
</tbody>
</table>
</div>

</div>
</div>
<p>Dimension reduction is done by just taking the first two columns of the score matrix.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>iris_scores <span class="ot">&lt;-</span> iris_centered<span class="sc">%*%</span>iris_eigen<span class="sc">$</span>vectors</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(iris_scores) <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">"Comp."</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">sep =</span> <span class="st">""</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>iris_scores[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="multivariate_statistics_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="factor-analysis" class="level1">
<h1>Factor Analysis</h1>
<p>Factor analysis serves to find underlying latent factors to observed variables. This is useful for cases in which the variable of interest cannot be measured directly (e.g.&nbsp;intelligence, social class) but is represented by some proxy variable (e.g.&nbsp;test scores, occupation and education).</p>
<section id="factor-model" class="level2">
<h2 class="anchored" data-anchor-id="factor-model">Factor Model</h2>
<p>The factor model in matrix notation is as follows <span class="math display">\[
X =\pmb{\Lambda} f + u
\]</span> in which</p>
<ul>
<li><span class="math inline">\(X \in \mathbb{R}^q\)</span> are the observed variables,</li>
<li><span class="math inline">\(\pmb{\Lambda} \in \mathbb{R}^{q\times k}\)</span> matrix containing the factor loadings,</li>
<li><span class="math inline">\(f \in \mathbb{R}^k\)</span> are the latent/common factors,</li>
<li><span class="math inline">\(u \in \mathbb{R}^q\)</span> are the specific factors.</li>
</ul>
<p><span class="math inline">\(X\)</span>, <span class="math inline">\(u\)</span>, and <span class="math inline">\(f\)</span> are random vectors, while <span class="math inline">\(\Lambda\)</span> is constant. It is important to note that <span class="math inline">\(f\)</span> is not observed, so <span class="math inline">\(\Lambda\)</span> and <span class="math inline">\(u\)</span> cannot be estimated with a least squares approach (in contrast to a regression model).</p>
<p>A number of things are assumed</p>
<ul>
<li><span class="math inline">\(E(u) = 0\)</span></li>
<li><span class="math inline">\(\mathrm{Cov}(u) = \Psi\)</span>, a diagonal matrix. The specific factors are uncorrelated.</li>
<li><span class="math inline">\(\mathrm{Cov}(f_l, u_j) = 0\)</span>, the common and specific factors are uncorrelated.</li>
<li><span class="math inline">\(E(X) = 0\)</span>, the data is mean-centered.</li>
<li><span class="math inline">\(E(f) = 0\)</span>, <span class="math inline">\(\mathrm{Cov}(f) = I\)</span>, latent factors are standardized with a mean of zero, and a variance of one. They are uncorrelated.</li>
</ul>
<p>These assumptions imply that the common factors and the observed variables are uncorrelated. The correlation is established by the latent factors <span class="math inline">\(\Lambda\)</span>.</p>
<p><span class="math display">\[\begin{align*}
\pmb{\Sigma} &amp;= \mathrm{Cov}(\pmb{\Lambda} f+u) \\
&amp;= \mathrm{Cov}(\pmb{\Lambda} f) + \mathrm{Cov}(u) \\
&amp;= \pmb{\Lambda}\mathrm{Cov}(f)\pmb{\Lambda}^T+\pmb{\Psi}\\
&amp;= \pmb{\Lambda\Lambda}^T + \pmb{\Psi}\\
\end{align*}\]</span></p>
<p>Writing as scalars, this equals <span class="math display">\[
\sigma^2_j = \Sigma_{l=1}^k \lambda^2_{jl} + \psi_j = h_j^2 + \psi_j
\]</span></p>
<p>in which <span class="math inline">\(h_j^2\)</span> is the communality, the variance resulting from the latent factors, and <span class="math inline">\(\psi_j\)</span> the specific variance, that is not shared among the observed variables. If the above expression holds, then the factor model holds for <span class="math inline">\(X\)</span>.</p>
<p>The factor model is scale-invariant, meaning that scaling the loadings and specific variances after applying factor analysis is equal to applying factor analysis to scaled variables.</p>
<p><span class="math display">\[\begin{align*}
\pmb{Y} &amp;= \pmb{CX}, \pmb{C} = \mathrm{diag}(c_j)\\
\mathrm{Cov}(\pmb{Y}) &amp;= \pmb{C}\mathrm{Cov}(\pmb{X})\pmb{C}^T \\
&amp;= (\pmb{C\Lambda})(\pmb{C\Lambda})^T + \pmb{C\Psi C}^T \\
&amp;= \tilde{\pmb{\Lambda}}\tilde{\pmb{\Lambda}}^T + \tilde{\pmb{\Psi}}\\
\tilde{\pmb{\Lambda}} &amp;= \pmb{C\Lambda}, \tilde{\pmb{\Psi}} = \pmb{C\Psi C}^T
\end{align*}\]</span></p>
</section>
<section id="estimation" class="level2">
<h2 class="anchored" data-anchor-id="estimation">Estimation</h2>
<p>Both the factor loadings <span class="math inline">\(\pmb{\Lambda}\)</span> and the specific variances <span class="math inline">\(\pmb{\Psi}\)</span> require estimation. They are connected to the covariance matrix <span class="math inline">\(\pmb{\Sigma}\)</span> by the expression <span class="math display">\[
\pmb{\Sigma} = \pmb{\Lambda\Lambda}^T + \pmb{\Psi}
\]</span></p>
<p>Estimation of both <span class="math inline">\(\pmb{\Lambda}\)</span> and <span class="math inline">\(\pmb{\Psi}\)</span> from this equation starts by initializing <span class="math inline">\(\hat{\pmb{\Psi}}\)</span> with <span class="math display">\[
\hat{\psi}_j = 1-\hat{h}_j^2
\]</span> in which <span class="math inline">\(\hat{h}_j^2\)</span> is either the square of the multiple correlation coefficient of the <span class="math inline">\(j\)</span>-th variable with all other variables or the largest correlation coefficient between <span class="math inline">\(j\)</span> and another variable. Subsequently, <span class="math inline">\(\pmb{\Lambda}\)</span> can be estimated by spectral decomposition (using the correlation matrix <span class="math inline">\(\pmb{R}\)</span> instead of the covariance matrix) of <span class="math display">\[
\pmb{R}-\hat{\pmb{\Psi}} = \hat{\pmb{\Lambda}}\hat{\pmb{\Lambda}}^T = \pmb{A\Omega A}^T = \left(\pmb{A\Omega^\frac{1}{2}}\right) \left(\pmb{A\Omega^\frac{1}{2}}\right)^T
\]</span> Only the first <span class="math inline">\(k\)</span> eigenvalues and eigenvectors are kept, corresponding to the number of factors chosen for the model. These reduced eigenvalues and eigenvectors are used to populate the loadings <span class="math display">\[
\hat{\pmb{\Lambda}}  = \pmb{A_1\Omega_1}^\frac{1}{2}
\]</span></p>
<p>This estimate is then used to estimate the specific factors <span class="math inline">\(\hat{\pmb{\Psi}}\)</span> <span class="math display">\[
\hat{\pmb{\Psi}} = \pmb{R} - \hat{\pmb{\Lambda}}\hat{\pmb{\Lambda}}^T
\]</span> <span class="math inline">\(\hat{\pmb{\Lambda}}\)</span> and <span class="math inline">\(\hat{\pmb{\Psi}}\)</span> are iteratively re-estimated until convergence. Alternatively, parameter estimation can be done by using maximum likelyhood estimation, assuming that the variables follow a multivariate normal distribution.</p>
<p><span class="math display">\[
l\left(\pmb{\Psi}, \pmb{\Lambda}\right) = -\frac{n}{2}\left(\log\left(2\pi\pmb{\Sigma}\right)+\mathrm{Tr}\left(\pmb{\Sigma}^{-1}S\right)\right)
\]</span> Factor analysis using the maximum likelyhood approach is available in <code>R</code> via the <code>factanal</code> function.</p>
</section>
<section id="heywood-cases" class="level2">
<h2 class="anchored" data-anchor-id="heywood-cases">Heywood Cases</h2>
<p>It is possible that some <span class="math inline">\(\hat{\psi}_j &lt; 0\)</span> or <span class="math inline">\(\hat{\psi}_j &gt; 1\)</span>. These cases are called <em>Heywood cases</em> and violate that variances need to be positive and the normalization of the variance per variable <span class="math display">\[
1 = \hat{h}_j^2 + \hat{\psi}_j
\]</span> Heywood cases can be approached by</p>
<ul>
<li>collecting more data,</li>
<li>using a different model (number of factors, variables),</li>
<li>trying a different estimation technique.</li>
</ul>
</section>
<section id="number-of-factors" class="level2">
<h2 class="anchored" data-anchor-id="number-of-factors">Number of Factors</h2>
<p>Hypothesis testing can be used to test whether the chosen number of factors is sufficient. The hypotheses are <span class="math display">\[\begin{align*}
H_0&amp;: \text{$k$-factor model holds true} \\
H_1&amp;: \text{$\pmb{\Sigma}$ is more general (higher k necessary)}\\
\end{align*}\]</span> This hypothesis test included in the <code>R</code> output of factor analysis by default.</p>
</section>
<section id="interpretation-of-factor-loadings" class="level2">
<h2 class="anchored" data-anchor-id="interpretation-of-factor-loadings">Interpretation of Factor Loadings</h2>
<p>There is no precise way of interpreting factor loadings, it can rather involve creativity and be debatable. Interpretation of factor loadings may be facilitated by rotations, which may change the loadings to be more interpretable. This is possible due to the <em>non-uniqueness</em> of a factor model.</p>
<p>Assuming a rotation matrix <span class="math inline">\(\pmb{M}\)</span> and transformations <span class="math inline">\(f^* = \pmb{M}^Tf\)</span> and <span class="math inline">\(\pmb{\Lambda}^* = \pmb{\Lambda}\pmb{M}\)</span>, it can be shown that the resulting factor model is identical to the untransformed model.</p>
<p><span class="math display">\[\begin{align*}
\pmb{X}^* &amp;= \pmb{\Lambda}^* f^* + u = \left(\pmb{\Lambda}\pmb{M}\right)\left(\pmb{M}^T f\right) + u = \pmb{\Lambda} f + u = \pmb{X} \\
\pmb{\Sigma}^* &amp;= \pmb{\Lambda}^*{\pmb{\Lambda}^*}^T + \pmb{\Psi} = \left(\pmb{\Lambda}\pmb{M}\right)\left(\pmb{\Lambda}\pmb{M}\right)^T + \pmb{\Psi} = \pmb{\Lambda}\pmb{\Lambda}^T + \pmb{\Psi} =\pmb{\Sigma}
\end{align*}\]</span></p>
<p>Non-uniqueness can be approached by imposing restrictions on the model parametrization, which is commonly done by estimation procedures. In addition, the rotations mentioned above can be used to increase the interpretability of the factor loadings. Interpretation is made easier if every variable has a high loading on at most one factor, and if all factor loadings are either large and positive, or zero. Two types of rotations exist that attempt to acheive this.</p>
<ul>
<li><strong>Orthogonal rotations</strong> require the factors to be uncorrelated. This is useful, since the loadings still represent covariances between latent factors and observed variables. The <em>varimax</em> rotation is a commonly used orthogonal rotation and default in the <code>factanal</code> function of <code>R</code>.</li>
<li><strong>Oblique rotations</strong> allow the factors to be correlated, as it may lead to better interpretable factors. The <em>promax</em> rotation is an example for an oblique rotation which aims at a simple structure with low correlation between factors.</li>
</ul>
</section>
<section id="estimation-of-factor-scores" class="level2">
<h2 class="anchored" data-anchor-id="estimation-of-factor-scores">Estimation of Factor Scores</h2>
<p>It is possible to estimate factor scores for individual observations that represent scores of latent variables. Multiple methods of estimating factor scores exist, but they often yield very similar results in practice.</p>
<p><strong>Thompson’s method</strong> estimates factor scores <span class="math inline">\(\hat{f}_i \in \mathbb{R}^k\)</span> by <span class="math display">\[
\hat{f}_i = \hat{\pmb{\Lambda}}^T\hat{\pmb{\Sigma}}^{-1}x_i
\]</span> which is available via the option <code>scores="regression"</code> in the <code>R</code> function <code>factanal</code>.</p>
</section>
<section id="comparison-between-fa-pca" class="level2">
<h2 class="anchored" data-anchor-id="comparison-between-fa-pca">Comparison between FA &amp; PCA</h2>
<p>Comparing the models of factor analysis and principle component analysis <span class="math display">\[\begin{align*}
\text{FA: } \pmb{X} &amp;= \pmb{\Lambda}f + u\\
\text{PCA: } X &amp;= \pmb{A}_1^T Y^{(1)}+ \pmb{A}_2^T Y^{(2)} =  \pmb{A}_1^T Y^{(1)} + e
\end{align*}\]</span> shows that one of the differences is that <span class="math inline">\(\mathrm{Cov}(u)\)</span> is diagonal by assumption, while <span class="math inline">\(\mathrm{Cov}(e)\)</span> is usually not diagonal.</p>
<ul>
<li>FA and PCA reduce the dimensionality of data</li>
<li>Do not yield results if the observed variables are uncorrelated
<ul>
<li>PC components are similar to the original variables</li>
<li>FA cannot find variance shared among the variables, thus the specific variance will be close to one</li>
</ul></li>
<li>The results of PCA and FA become more similar, the smaller the specific variance is. The results become identical (up to rotation) if the specific variance is zero <span class="math display">\[
\pmb{\Sigma} = \pmb{\Lambda}\pmb{\Lambda}^T + \pmb{\Psi} \overset{\pmb{\Psi} = 0}{=}  \pmb{\Lambda}\pmb{\Lambda}^T
\]</span> The resulting spectral decomposition is the same for both PCA and FA</li>
</ul>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>